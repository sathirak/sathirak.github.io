<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/c6590e94fb93f6bd-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/feec6f6f0d18f76b-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="/content/homelab-part-2-kubernetes/assets/main.jpg"/><link rel="stylesheet" href="/_next/static/css/48a2c5237f5bb7f4.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/164e025efb19ed03.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-9ad189c10e7b69a4.js"/><script src="/_next/static/chunks/629b3d23-75836dc436a5117d.js" async=""></script><script src="/_next/static/chunks/2775-19835826eed0be7c.js" async=""></script><script src="/_next/static/chunks/main-app-fb3e61d6abc7abe0.js" async=""></script><script src="/_next/static/chunks/9727-6089021ff52e6069.js" async=""></script><script src="/_next/static/chunks/app/layout-35259d5db6a00635.js" async=""></script><script src="/_next/static/chunks/636f95dc-94e8b2abb494893b.js" async=""></script><script src="/_next/static/chunks/1192-e62d2923b46be3af.js" async=""></script><script src="/_next/static/chunks/app/devlog/%5Bslug%5D/page-ed91dd5d466b76f8.js" async=""></script><link rel="preload" href="https://www.googletagmanager.com/gtm.js?id=G-EVEP2QMLHF" as="script"/><meta name="next-size-adjust" content=""/><link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96"/><link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg"/><link rel="shortcut icon" href="/favicon/favicon.ico"/><link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png"/><link rel="manifest" href="/favicon/site.webmanifest"/><title>Homelab Part 2, Kubernetes | Devlog</title><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_dbfe30 w-full text-zinc-800 selection:bg-black selection:text-white"><header class="border-b z-10 top-0 sticky flex justify-between items-center p-4 w-full bg-white bg-clip-padding backdrop-filter  backdrop-blur-sm bg-opacity-40 backdrop-saturate-100 backdrop-contrast-100"><a href="/" class="flex items-center gap-4 select-none cursor-pointer"><img alt="Grotto Logo" loading="lazy" width="100" height="100" decoding="async" data-nimg="1" class="size-10" style="color:transparent" src="/_next/static/media/ice.c4f0c603.png"/><span class="font-medium text-2xl select-none">Grotto</span></a></header><main class="flex flex-col items-center relative"><section class="w-full px-4 lg:w-3/5 gap-4 my-8 lg:flex "><div class="lg:w-1/2"><h1 class="text-4xl lg:text-5xl font-medium mb-6 __className_dbfe30">Homelab Part 2, Kubernetes</h1><p class="text-2xl text-zinc-700 mb-6">Configuring Kubernetes and ArgoCD for my homelab</p></div><img class="select-none rounded-md lg:w-1/2 aspect-video object-cover" src="/content/homelab-part-2-kubernetes/assets/main.jpg" alt="Homelab Part 2, Kubernetes"/></section><section class="w-full px-4 lg:w-1/2 my-8 text-lg __className_618921"><p class="my-4">In the last part of the Homelab series, we configured Terraform so our VPS can effectively be spawned and despawned via commands.
Now we need to configure our homelab so we can use it to deploy and test applications. Basically, we need to run Kubernetes on our server.</p>
<h2 class="text-3xl font-medium mt-8 mb-4 hover:text-zinc-600 transition-colors __className_dbfe30" id="many-types-of-kubernetes"><a href="#many-types-of-kubernetes">Many types of Kubernetes</a></h2>
<p class="my-4">There are six main ways to run Kubernetes on a server (IDK there might be more):</p>
<p class="my-4"><a class="text-teal-500 hover:text-orange-500 visited:text-yellow-500 underline transition-colors" target="_blank" rel="noopener noreferrer" href="https://www.talos.dev/">Talos</a> - Basically a fully fledged Linux distro made for Kubernetes, communication is done via an API, hence minimal, secure and production grade.</p>
<p class="my-4"><a class="text-teal-500 hover:text-orange-500 visited:text-yellow-500 underline transition-colors" target="_blank" rel="noopener noreferrer" href="https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/">Kubeadm</a> - Made by Kubernetes themselves, no out-of-the-box experience, needs setup and is hard to manage.</p>
<p class="my-4"><a class="text-teal-500 hover:text-orange-500 visited:text-yellow-500 underline transition-colors" target="_blank" rel="noopener noreferrer" href="https://k3s.io/">K3s</a> - Optimized, constrained mini K8s distribution, low production grade, easy to manage.</p>
<p class="my-4"><a class="text-teal-500 hover:text-orange-500 visited:text-yellow-500 underline transition-colors" target="_blank" rel="noopener noreferrer" href="https://k0sproject.io/">K0s</a> - Production grade bare metal K8s distro, minimal and self-contained.</p>
<p class="my-4"><a class="text-teal-500 hover:text-orange-500 visited:text-yellow-500 underline transition-colors" target="_blank" rel="noopener noreferrer" href="https://minikube.sigs.k8s.io/docs/">Minikube</a> - Used for locally testing and development</p>
<p class="my-4"><a class="text-teal-500 hover:text-orange-500 visited:text-yellow-500 underline transition-colors" target="_blank" rel="noopener noreferrer" href="https://microk8s.io/">MicroK8s</a> - Made by the guys who made Ubuntu, based on snap and plugins, heavier resource use.</p>
<h2 class="text-3xl font-medium mt-8 mb-4 hover:text-zinc-600 transition-colors __className_dbfe30" id="k3s"><a href="#k3s">K3s</a></h2>
<p class="my-4">There are many Kubernetes distributions, but for now we are going to use k3s.</p>
<p class="my-4">Why? It&#x27;s easy to manage, has full Kubernetes API support, and can be used with Rancher ecosystems.</p>
<p class="my-4">However, ideally we want to use Talos, because it&#x27;s production grade and we need to be able to debug production grade clusters.</p>
<p class="my-4">First of all, we&#x27;ll need to edit our homelab.tf config to be able to download K3s.</p>
<p class="my-4">You can refer to this <a class="text-teal-500 hover:text-orange-500 visited:text-yellow-500 underline transition-colors" target="_blank" rel="noopener noreferrer" href="https://www.digitalocean.com/community/tutorials/how-to-setup-k3s-kubernetes-cluster-on-ubuntu">Guide</a> if you need more info.</p>
<p class="my-4">Basically this command is enough for that.</p>
<article><div class="relative text-sm border block p-4 my-4 rounded-md"><div class="flex justify-between items-center pb-4"><h6></h6><button type="button" class="p-1 hover:bg-gray-100 rounded-md" title="Copy to clipboard"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" stroke="currentColor" class="size-4 hover:scale-125 transition-transform"><title>clipboard</title><g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><path d="M6.25 2.75h-1a2 2 0 0 0-2 2v9.5a2 2 0 0 0 2 2h7.5a2 2 0 0 0 2-2v-9.5a2 2 0 0 0-2-2h-1"></path><rect width="5.5" height="3" x="6.25" y="1.25" rx="1" ry="1"></rect></g></svg></button></div><div><code></code></div></div></article>
<h2 class="text-3xl font-medium mt-8 mb-4 hover:text-zinc-600 transition-colors __className_dbfe30" id="argocd"><a href="#argocd">ArgoCD</a></h2>
<p class="my-4">Now actually we have docker, kubectl and k3s installed. So we have a fully operational Kubernetes cluster waiting to be used.</p>
<p class="my-4">But we&#x27;re not going to stop there, we&#x27;ll also be installing ArgoCD.</p>
<p class="my-4">ArgoCD my beloved GitOps thingy. It makes a lot of things a lot more easier.</p>
<p class="my-4">Anywho, this requires a little bit of configuring. First in our Cluster we can make a new namespace and install argocd via its manifest</p>
<article><div class="relative text-sm border block p-4 my-4 rounded-md"><div class="flex justify-between items-center pb-4"><h6></h6><button type="button" class="p-1 hover:bg-gray-100 rounded-md" title="Copy to clipboard"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" stroke="currentColor" class="size-4 hover:scale-125 transition-transform"><title>clipboard</title><g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><path d="M6.25 2.75h-1a2 2 0 0 0-2 2v9.5a2 2 0 0 0 2 2h7.5a2 2 0 0 0 2-2v-9.5a2 2 0 0 0-2-2h-1"></path><rect width="5.5" height="3" x="6.25" y="1.25" rx="1" ry="1"></rect></g></svg></button></div><div><code></code></div></div></article>
<p class="my-4">Like so.</p>
<p class="my-4">Then we&#x27;ll need to wait until all of the argocd pods are done and running</p>
<article><div class="relative text-sm border block p-4 my-4 rounded-md"><div class="flex justify-between items-center pb-4"><h6></h6><button type="button" class="p-1 hover:bg-gray-100 rounded-md" title="Copy to clipboard"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" stroke="currentColor" class="size-4 hover:scale-125 transition-transform"><title>clipboard</title><g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><path d="M6.25 2.75h-1a2 2 0 0 0-2 2v9.5a2 2 0 0 0 2 2h7.5a2 2 0 0 0 2-2v-9.5a2 2 0 0 0-2-2h-1"></path><rect width="5.5" height="3" x="6.25" y="1.25" rx="1" ry="1"></rect></g></svg></button></div><div><code></code></div></div></article>
<p class="my-4">Now ArgoCD is running in your Cluster, but the thing is we need to use the ArgoCD UI, but how?</p>
<p class="my-4">You see when running ArgoCD in local machines it&#x27;s easy to get its UI from the browser, but in a VPS like this, we may need to expose the ArgoCD UI via a NodePort</p>
<article><div class="relative text-sm border block p-4 my-4 rounded-md"><div class="flex justify-between items-center pb-4"><h6></h6><button type="button" class="p-1 hover:bg-gray-100 rounded-md" title="Copy to clipboard"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" stroke="currentColor" class="size-4 hover:scale-125 transition-transform"><title>clipboard</title><g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><path d="M6.25 2.75h-1a2 2 0 0 0-2 2v9.5a2 2 0 0 0 2 2h7.5a2 2 0 0 0 2-2v-9.5a2 2 0 0 0-2-2h-1"></path><rect width="5.5" height="3" x="6.25" y="1.25" rx="1" ry="1"></rect></g></svg></button></div><div><code></code></div></div></article>
<p class="my-4">We can use the above command to patch the type of service to a NodePort, this exposes our ArgoCD UI via the VPS&#x27;s IP address</p>
<p class="my-4">You can then use this command to get all the details about the exposed ArgoCD service</p>
<article><div class="relative text-sm border block p-4 my-4 rounded-md"><div class="flex justify-between items-center pb-4"><h6></h6><button type="button" class="p-1 hover:bg-gray-100 rounded-md" title="Copy to clipboard"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" stroke="currentColor" class="size-4 hover:scale-125 transition-transform"><title>clipboard</title><g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><path d="M6.25 2.75h-1a2 2 0 0 0-2 2v9.5a2 2 0 0 0 2 2h7.5a2 2 0 0 0 2-2v-9.5a2 2 0 0 0-2-2h-1"></path><rect width="5.5" height="3" x="6.25" y="1.25" rx="1" ry="1"></rect></g></svg></button></div><div><code></code></div></div></article>
<p class="my-4">You can access your ArgoCD UI using your IP address and the 443 mapped port number (let&#x27;s assume it&#x27;s 320001) like this: http://YOUR_IP_ADDRESS:320001</p>
<p class="my-4">You will also need the password for ArgoCD, which can be retrieved using the following command (note that it&#x27;s base64 encoded):</p>
<article><div class="relative text-sm border block p-4 my-4 rounded-md"><div class="flex justify-between items-center pb-4"><h6></h6><button type="button" class="p-1 hover:bg-gray-100 rounded-md" title="Copy to clipboard"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" stroke="currentColor" class="size-4 hover:scale-125 transition-transform"><title>clipboard</title><g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"><path d="M6.25 2.75h-1a2 2 0 0 0-2 2v9.5a2 2 0 0 0 2 2h7.5a2 2 0 0 0 2-2v-9.5a2 2 0 0 0-2-2h-1"></path><rect width="5.5" height="3" x="6.25" y="1.25" rx="1" ry="1"></rect></g></svg></button></div><div><code></code></div></div></article>
<p class="my-4">And that&#x27;s how I installed kubernetes and exposed ArgoCD UI in homelab.</p></section></main><script src="/_next/static/chunks/webpack-9ad189c10e7b69a4.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[57969,[\"9727\",\"static/chunks/9727-6089021ff52e6069.js\",\"7177\",\"static/chunks/app/layout-35259d5db6a00635.js\"],\"GoogleTagManager\"]\n3:I[9680,[\"9727\",\"static/chunks/9727-6089021ff52e6069.js\",\"7177\",\"static/chunks/app/layout-35259d5db6a00635.js\"],\"SeasonalIcon\"]\n4:I[46286,[],\"\"]\n5:I[46852,[],\"\"]\n7:I[1391,[],\"OutletBoundary\"]\n9:I[1391,[],\"MetadataBoundary\"]\nb:I[1391,[],\"ViewportBoundary\"]\nd:I[53865,[],\"\"]\n:HL[\"/_next/static/media/c6590e94fb93f6bd-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/media/feec6f6f0d18f76b-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n:HL[\"/_next/static/css/48a2c5237f5bb7f4.css\",\"style\"]\n:HL[\"/_next/static/css/164e025efb19ed03.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"fWTlN-V4yH7mg7p8RU-5F\",\"p\":\"\",\"c\":[\"\",\"devlog\",\"homelab-part-2-kubernetes\",\"\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"devlog\",{\"children\":[[\"slug\",\"homelab-part-2-kubernetes\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/48a2c5237f5bb7f4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/164e025efb19ed03.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/png\",\"href\":\"/favicon/favicon-96x96.png\",\"sizes\":\"96x96\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"type\":\"image/svg+xml\",\"href\":\"/favicon/favicon.svg\"}],[\"$\",\"link\",null,{\"rel\":\"shortcut icon\",\"href\":\"/favicon/favicon.ico\"}],[\"$\",\"link\",null,{\"rel\":\"apple-touch-icon\",\"sizes\":\"180x180\",\"href\":\"/favicon/apple-touch-icon.png\"}],[\"$\",\"link\",null,{\"rel\":\"manifest\",\"href\":\"/favicon/site.webmanifest\"}]]}],[\"$\",\"$L2\",null,{\"gtmId\":\"G-EVEP2QMLHF\"}],[\"$\",\"body\",null,{\"className\":\"__className_dbfe30 w-full text-zinc-800 selection:bg-black selection:text-white\",\"children\":[[\"$\",\"header\",null,{\"className\":\"border-b z-10 top-0 sticky flex justify-between items-center p-4 w-full bg-white bg-clip-padding backdrop-filter  backdrop-blur-sm bg-opacity-40 backdrop-saturate-100 backdrop-contrast-100\",\"children\":[\"$\",\"a\",null,{\"href\":\"/\",\"className\":\"flex items-center gap-4 select-none cursor-pointer\",\"children\":[[\"$\",\"$L3\",null,{\"className\":\"size-10\",\"alt\":\"Grotto Logo\"}],[\"$\",\"span\",null,{\"className\":\"font-medium text-2xl select-none\",\"children\":\"Grotto\"}]]}]}],[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}]]}]]}],{\"children\":[\"devlog\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"devlog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"slug\",\"homelab-part-2-kubernetes\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L4\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"devlog\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L5\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L6\",null,[\"$\",\"$L7\",null,{\"children\":\"$L8\"}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"OJWgfrL4gFCP0Wmfsu_qz\",{\"children\":[[\"$\",\"$L9\",null,{\"children\":\"$La\"}],[\"$\",\"$Lb\",null,{\"children\":\"$Lc\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"e:I[25479,[\"6443\",\"static/chunks/636f95dc-94e8b2abb494893b.js\",\"1192\",\"static/chunks/1192-e62d2923b46be3af.js\",\"4120\",\"static/chunks/app/devlog/%5Bslug%5D/page-ed91dd5d466b76f8.js\"],\"Devlog\"]\nf:I[4740,[\"6443\",\"static/chunks/636f95dc-94e8b2abb494893b.js\",\"1192\",\"static/chunks/1192-e62d2923b46be3af.js\",\"4120\",\"static/chunks/app/devlog/%5Bslug%5D/page-ed91dd5d466b76f8.js\"],\"Code\",1]\n"])</script><script>self.__next_f.push([1,"6:[\"$\",\"$Le\",null,{\"slug\":\"homelab-part-2-kubernetes\",\"title\":\"Homelab Part 2, Kubernetes\",\"description\":\"Configuring Kubernetes and ArgoCD for my homelab\",\"children\":[[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"In the last part of the Homelab series, we configured Terraform so our VPS can effectively be spawned and despawned via commands.\\nNow we need to configure our homelab so we can use it to deploy and test applications. Basically, we need to run Kubernetes on our server.\"}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"text-3xl font-medium mt-8 mb-4 hover:text-zinc-600 transition-colors __className_dbfe30\",\"children\":[\"$\",\"a\",null,{\"href\":\"#many-types-of-kubernetes\",\"children\":\"Many types of Kubernetes\"}],\"id\":\"many-types-of-kubernetes\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"There are six main ways to run Kubernetes on a server (IDK there might be more):\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":[[\"$\",\"a\",null,{\"className\":\"text-teal-500 hover:text-orange-500 visited:text-yellow-500 underline transition-colors\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.talos.dev/\",\"children\":\"Talos\"}],\" - Basically a fully fledged Linux distro made for Kubernetes, communication is done via an API, hence minimal, secure and production grade.\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":[[\"$\",\"a\",null,{\"className\":\"text-teal-500 hover:text-orange-500 visited:text-yellow-500 underline transition-colors\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/\",\"children\":\"Kubeadm\"}],\" - Made by Kubernetes themselves, no out-of-the-box experience, needs setup and is hard to manage.\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":[[\"$\",\"a\",null,{\"className\":\"text-teal-500 hover:text-orange-500 visited:text-yellow-500 underline transition-colors\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://k3s.io/\",\"children\":\"K3s\"}],\" - Optimized, constrained mini K8s distribution, low production grade, easy to manage.\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":[[\"$\",\"a\",null,{\"className\":\"text-teal-500 hover:text-orange-500 visited:text-yellow-500 underline transition-colors\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://k0sproject.io/\",\"children\":\"K0s\"}],\" - Production grade bare metal K8s distro, minimal and self-contained.\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":[[\"$\",\"a\",null,{\"className\":\"text-teal-500 hover:text-orange-500 visited:text-yellow-500 underline transition-colors\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://minikube.sigs.k8s.io/docs/\",\"children\":\"Minikube\"}],\" - Used for locally testing and development\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":[[\"$\",\"a\",null,{\"className\":\"text-teal-500 hover:text-orange-500 visited:text-yellow-500 underline transition-colors\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://microk8s.io/\",\"children\":\"MicroK8s\"}],\" - Made by the guys who made Ubuntu, based on snap and plugins, heavier resource use.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"text-3xl font-medium mt-8 mb-4 hover:text-zinc-600 transition-colors __className_dbfe30\",\"children\":[\"$\",\"a\",null,{\"href\":\"#k3s\",\"children\":\"K3s\"}],\"id\":\"k3s\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"There are many Kubernetes distributions, but for now we are going to use k3s.\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Why? It's easy to manage, has full Kubernetes API support, and can be used with Rancher ecosystems.\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"However, ideally we want to use Talos, because it's production grade and we need to be able to debug production grade clusters.\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"First of all, we'll need to edit our homelab.tf config to be able to download K3s.\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":[\"You can refer to this \",[\"$\",\"a\",null,{\"className\":\"text-teal-500 hover:text-orange-500 visited:text-yellow-500 underline transition-colors\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"href\":\"https://www.digitalocean.com/community/tutorials/how-to-setup-k3s-kubernetes-cluster-on-ubuntu\",\"children\":\"Guide\"}],\" if you need more info.\"]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Basically this command is enough for that.\"}],\"\\n\",[\"$\",\"$Lf\",null,{\"lang\":\"bash\",\"code\":\"\\ncurl -sfL https://get.k3s.io | sh -\\nsudo chmod 644 /etc/rancher/k3s/k3s.yaml\\n\"}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"text-3xl font-medium mt-8 mb-4 hover:text-zinc-600 transition-colors __className_dbfe30\",\"children\":[\"$\",\"a\",null,{\"href\":\"#argocd\",\"children\":\"ArgoCD\"}],\"id\":\"argocd\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Now actually we have docker, kubectl and k3s installed. So we have a fully operational Kubernetes cluster waiting to be used.\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"But we're not going to stop there, we'll also be installing ArgoCD.\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"ArgoCD my beloved GitOps thingy. It makes a lot of things a lot more easier.\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Anywho, this requires a little bit of configuring. First in our Cluster we can make a new namespace and install argocd via its manifest\"}],\"\\n\",[\"$\",\"$Lf\",null,{\"lang\":\"bash\",\"code\":\"\\nkubectl create namespace argocd\\nkubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml\\n\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Like so.\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Then we'll need to wait until all of the argocd pods are done and running\"}],\"\\n\",[\"$\",\"$Lf\",null,{\"lang\":\"bash\",\"code\":\"\\nkubectl wait --for=condition=Ready pods --all -n argocd --timeout=300s\\n\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"Now ArgoCD is running in your Cluster, but the thing is we need to use the ArgoCD UI, but how?\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"You see when running ArgoCD in local machines it's easy to get its UI from the browser, but in a VPS like this, we may need to expose the ArgoCD UI via a NodePort\"}],\"\\n\",[\"$\",\"$Lf\",null,{\"lang\":\"bash\",\"code\":\"\\nkubectl patch svc argocd-server -n argocd -p '{\\\"spec\\\": {\\\"type\\\": \\\"NodePort\\\"}}'\\n\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"We can use the above command to patch the type of service to a NodePort, this exposes our ArgoCD UI via the VPS's IP address\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"You can then use this command to get all the details about the exposed ArgoCD service\"}],\"\\n\",[\"$\",\"$Lf\",null,{\"lang\":\"bash\",\"code\":\"\\nkubectl get svc argocd-server -n argocd\\n\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"You can access your ArgoCD UI using your IP address and the 443 mapped port number (let's assume it's 320001) like this: http://YOUR_IP_ADDRESS:320001\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"You will also need the password for ArgoCD, which can be retrieved using the following command (note that it's base64 encoded):\"}],\"\\n\",[\"$\",\"$Lf\",null,{\"lang\":\"bash\",\"code\":\"\\nkubectl -n argocd get secret argocd-initial-admin-secret -o jsonpath=\\\"{.data.password}\\\" | base64 -d\\n\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"my-4\",\"children\":\"And that's how I installed kubernetes and exposed ArgoCD UI in homelab.\"}]]}]\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Homelab Part 2, Kubernetes | Devlog\"}]]\n"])</script><script>self.__next_f.push([1,"8:null\n"])</script></body></html>